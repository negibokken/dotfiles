# タスクガイド

## 要件定義ガイド

要件定義書を作りたいと言った場合は、下記のフォーマットに従って作成するのを手伝ってください。

```markdown
## 概要

機能要件の概要を記載。

## 要件

1. 要件 1: 要件の名前
    - ユーザーストーリー「ユーザーは〜したい、なぜなら〜だからだ」の形式で記載。
    - 受け入れ基準: ユーザーストーリーが満たされていることを確認するための基準を記載。
2. 要件 2: 要件の名前
    - ユーザーストーリー「ユーザーは〜したい、なぜなら〜だからだ」の形式で記載。
    - 受け入れ基準: ユーザーストーリーが満たされていることを確認するための基準を記載。
```

それぞれ不明点を明らかにするように質問を行い、必要な情報を収集してください。
作成した要件定義書は`./claude/requirements/${要件のタイトル}.md`に出力してください。

## 開発ガイド

### 作業をはじめるときに

作業をはじめるときに develop, main, master といった主要ブランチにいる場合は、最新のコミットをフェッチしてからチェックアウトして修正のためのブランチを作ってから作業を進めてください。
なるべく細かい単位で commit してください。commit は指示がなくても適切なタイミングで行ってください。
作業後に develop や、main、master ブランチにいない場合は git push してください。

### コミットをするとき

コミットはできる限り細かい粒度でコミットしてください。
また、コミットする前に変更したファイルに対して format コマンドを実行してください。
基本的には 1 ファイルずつが原則ですが、意味がある場合は複数ファイルをまとめてコミットしても構いません。
また、コミットの順番もレビューをする人がわかりやすいようにコミットしてください。
最後にコミットの順番を見直し、分かりにくい場合は並び替えたり、コミットをまとめたりしてください。

### PR を作成するとき

gh コマンドを使って PR を作成してください。
ただし、PR をは必ず draft にしてください。
PR のタイトルは英語で記載してください。
PR の本文には各コミットでどのようなことをしたか簡単に記載してください。

### 代替コマンド

一部のコマンドは rust で実装された代替コマンドを使用しています。

-   find は fd コマンドを使ってください
-   grep は ripgrep (rg) コマンドを使ってください

### Todo が一度完了したら

Todo が完了したら、最後に`/retrospective` コマンドを実行して作業の振り返りをするように提案してください。

## 日付について言われたとき

タイムゾーンは、UTC+9（日本標準時）で考えてください。

今日の日付などはシステム情報を参照せずにコマンドを実行して正しい日付を確認してください。次のようなコマンドです。

```bash
date
```

昨日の日付を確認する場合は、次のようにします。

```bash
date -d 'yesterday'
```

## コーディングガイドライン

-   コードはできる限りシンプルに記載し、関数内にすべての処理を記載するのではなく、小さい粒度で関数化してください
    -   目安としては 1 つの関数が 20 行を超えないようにしてください
-   また、関数もファイルを分けるなどして、できる限りファイルサイズを小さくしてください
-   プロジェクトにフォーマットツールがある場合は、**変更したファイルにのみ**必ずフォーマットを実行してください
-   プロジェクトにリントツールがある場合は、**変更したファイルにのみ**必ずリントを実行してください

## GitHub のサブ issue の作成について

GitHub でまとまった issue を作るときは、親 issue と sub-issue が存在していることが望ましい。

gh コマンドの拡張である
https://github.com/yahsan2/gh-sub-issue を使ってサブ issue を作れるようにしている。

サブ issue を作るときは下記のコマンドを実行する。

```sh
gh sub-issue create --parent 123 --title "Task" --repo owner/repo
```

`/review`は日本語でレビューを行ってください。

## 開発時において

### アイコン

MUST: 開発上アイコンを使うときは決して絵文字を使わないでください。
SVG アイコンや、外部のライブラリを使ってください。

-   メモリをかつようするために Serena MCP をできるだけつかってください。
-   最新のソフトウェアライブラリのドキュメントは context7 という mcp を使ってください。
